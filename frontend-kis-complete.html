<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>(Ï£º)ÌïúÍµ≠ÏÇ∞ÏóÖ - AI Í≤¨Ï†Å ÏãúÏä§ÌÖú</title>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        :root {
            --color-brand: #10a37f;
            --color-brand-strong: #0e8f71;
            --color-bg: #f7f7f8;
            --color-surface: #ffffff;
            --color-surface-2: #f3f2f1;
            --color-border: #e1dfdd;
            --color-text: #323130;
            --color-text-strong: #201f1e;
            --color-text-subtle: #605e5c;
            --color-error: #d13438;
            --radius-sm: 4px;
            --radius-md: 6px;
            --radius-lg: 8px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Noto Sans KR', -apple-system, BlinkMacSystemFont, sans-serif;
            font-size: 14px;
            line-height: 1.5;
            color: var(--color-text);
            background-color: var(--color-bg);
        }

        /* Typography */
        .h2-20 { font-size: 20px; font-weight: 600; line-height: 1.2; }
        .body-16 { font-size: 16px; line-height: 1.5; }
        .body-14 { font-size: 14px; line-height: 1.5; }
        .caption-12 { font-size: 12px; line-height: 1.3; }

        /* Layout */
        .app-container {
            height: 100vh;
            display: flex;
            background: var(--color-bg);
            overflow: hidden;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            height: 100%;
            background: var(--color-surface);
            border-right: 1px solid var(--color-border);
            display: flex;
            flex-direction: column;
            transition: all 0.2s ease-out;
        }

        .sidebar.collapsed {
            width: 80px;
        }

        .sidebar-header {
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid var(--color-border);
        }

        .sidebar-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--color-text-strong);
        }

        .sidebar.collapsed .sidebar-title {
            display: none;
        }

        .sidebar-content {
            flex: 1;
            overflow-y: auto;
            padding: 5px;
        }

        .sidebar-button {
            width: calc(100% - 24px);
            margin: 0 12px 16px;
            padding: 10px 16px;
            border: none;
            border-radius: var(--radius-md);
            background: var(--color-brand);
            color: white;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.2s ease;
        }

        .sidebar.collapsed .sidebar-button {
            width: 56px;
            margin: 0 12px 16px;
            justify-content: center;
            padding: 10px;
        }

        .sidebar.collapsed .sidebar-button-text {
            display: none;
        }

        .sidebar-button:hover {
            background: var(--color-brand-strong);
        }

        .sidebar-section {
            margin-bottom: 24px;
        }

        .sidebar-section-title {
            padding: 0 16px 8px;
            font-size: 15px;
            color: var(--color-text-subtle);
        }

        .sidebar.collapsed .sidebar-section-title {
            display: none;
        }

        .sidebar-nav-item {
            position: relative;
            width: 100%;
            height: 36px;
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 0 24px 0 24px;
            border: none;
            background: none;
            color: var(--color-text);
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .sidebar.collapsed .sidebar-nav-item {
            padding: 0 12px;
            justify-content: center;
        }

        .sidebar-nav-item:hover {
            background: var(--color-surface-2);
        }

        .sidebar-nav-item.active {
            background: var(--color-surface-2);
        }

        .sidebar-nav-item.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 3px;
            height: 24px;
            background: var(--color-brand);
            border-radius: 0 2px 2px 0;
        }

        .sidebar.collapsed .sidebar-nav-item-text {
            display: none;
        }

        .sidebar-chat-item {
            width: 100%;
            padding: 8px 16px 8px 28px;
            border: none;
            background: none;
            color: var(--color-text);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.15s ease;
        }

        .sidebar.collapsed .sidebar-chat-item {
            display: none;
        }

        .sidebar-chat-item:hover {
            background: var(--color-surface-2);
        }

        .sidebar-account {
            padding: 12px;
            border-top: 1px solid var(--color-border);
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
        }

        .sidebar.collapsed .sidebar-account-info {
            display: none;
        }

        .account-avatar {
            width: 24px;
            height: 24px;
            background: var(--color-brand);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: 600;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Hero Section */
        .hero-section {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 24px;
        }

        .hero-content {
            max-width: 800px;
            width: 100%;
            text-align: center;
        }

        .hero-title {
            font-size: 50px;
            line-height: 1.2;
            font-weight: 600;
            color: var(--color-text-strong);
            margin-bottom: 8px;
        }

        .hero-subtitle {
            font-size: 20px;
            color: var(--color-text-subtle);
            margin-bottom: 32px;
        }

        .hero-input-container {
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-lg);
            padding: 16px;
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .hero-input {
            flex: 1;
            border: none;
            outline: none;
            background: transparent;
            font-size: 16px;
            color: var(--color-text);
        }

        .hero-input::placeholder {
            color: var(--color-text-subtle);
        }

        .hero-send-button {
            padding: 8px;
            border: none;
            border-radius: var(--radius-md);
            background: var(--color-brand);
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .hero-send-button:hover {
            background: var(--color-brand-strong);
        }

        .prompt-chips {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px;
        }

        .prompt-chip {
            padding: 8px 16px;
            border: 1px solid var(--color-border);
            border-radius: 20px;
            background: var(--color-surface);
            color: var(--color-text);
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .prompt-chip:hover {
            border-color: var(--color-brand);
            background: var(--color-brand);
            color: white;
        }

        /* Chat View */
        .chat-view {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: var(--color-surface);
        }

        .chat-header {
            padding: 16px 24px;
            border-bottom: 1px solid var(--color-border);
            background: var(--color-surface);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
        }

        .chat-messages {
            max-width: 1000px;
            margin: 0 auto;
        }

        .date-divider {
            text-align: center;
            margin: 20px 0;
            color: var(--color-text-subtle);
            font-size: 14px;
        }

        .message {
            margin-bottom: 16px;
            display: flex;
            gap: 12px;
        }

        .message.user {
            justify-content: flex-end;
        }

        .message-content {
            max-width: 70%;
            padding: 12px 16px;
            border-radius: var(--radius-lg);
            line-height: 1.5;
        }

        .message.user .message-content {
            background: var(--color-brand);
            color: white;
        }

        .message.ai .message-content {
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            color: var(--color-text);
        }

        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 600;
        }

        .message.ai .message-avatar {
            background: var(--color-brand);
            color: white;
        }

        .message.user .message-avatar {
            background: var(--color-surface-2);
            color: var(--color-text);
        }

        .typing-indicator {
            display: flex;
            gap: 4px;
            padding: 12px 16px;
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-lg);
            max-width: 60px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--color-text-subtle);
            border-radius: 50%;
            animation: typing 1.4s ease-in-out infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { opacity: 0.3; }
            30% { opacity: 1; }
        }

        /* Quote System */
        .quote-system {
            height: 100vh;
            display: flex;
            flex-direction: column;
            background: var(--color-surface);
        }

        .quote-tabs {
            background: var(--color-surface);
            border-bottom: 1px solid var(--color-border);
            padding: 0 20px;
            display: flex;
            align-items: center;
        }

        .quote-tab {
            padding: 10px 16px;
            border: 1px solid #d1d1d1;
            border-bottom: none;
            background: #f9f9f9;
            cursor: pointer;
            margin-right: 2px;
            display: flex;
            align-items: center;
            border-radius: 4px 4px 0 0;
            transition: all 0.2s ease;
        }

        .quote-tab.active {
            background: white;
            border-color: var(--color-brand);
            color: var(--color-brand);
        }

        .quote-tab:hover:not(.active) {
            background: #f0f0f0;
        }

        .tab-close {
            margin-left: 8px;
            cursor: pointer;
            color: #999;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            line-height: 1;
        }

        .tab-close:hover {
            background: #e1dfdd;
            color: #666;
        }

        .new-tab {
            padding: 6px 10px;
            background: var(--color-brand);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-left: 10px;
            box-shadow: 0 2px 6px rgba(16, 163, 127, 0.25);
            transition: all 0.2s ease;
            font-size: 13px;
        }

        .new-tab:hover {
            background: var(--color-brand-strong);
        }

        .quote-content {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        .quote-left-panel {
            width: 500px;
            padding: 20px;
            overflow-y: auto;
            background: white;
            border-right: 1px solid var(--color-border);
        }

        .quote-right-panel {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: white;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .quote-section {
            margin-bottom: 20px;
            border: 1px solid var(--color-border);
            border-radius: 4px;
            background: white;
        }

        .quote-section-header {
            background: #f9f9f9;
            padding: 12px 16px;
            border-bottom: 1px solid var(--color-border);
            font-weight: 600;
            font-size: 14px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .quote-section-content {
            padding: 16px;
        }

        .form-grid-2x2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .form-row {
            display: flex;
            flex-direction: column;
            margin-bottom: 12px;
        }

        .form-row-horizontal {
            display: flex;
            gap: 8px;
            align-items: end;
            margin-bottom: 12px;
        }

        .form-label {
            font-size: 13px;
            color: var(--color-text-subtle);
            margin-bottom: 4px;
            font-weight: 500;
        }

        .form-input, .form-select {
            padding: 8px 12px;
            border: 1px solid #d1d1d1;
            border-radius: 2px;
            font-size: 14px;
            background: white;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--color-brand);
        }

        .toggle-container {
            display: flex;
            background: #f0f0f0;
            border-radius: 20px;
            padding: 2px;
            border: 1px solid #d1d1d1;
        }

        .toggle-option {
            padding: 4px 12px;
            border-radius: 18px;
            background: transparent;
            color: #666;
            border: none;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }

        .toggle-option.active {
            background: var(--color-brand);
            color: white;
        }

        .oval-toggle {
            padding: 8px 16px;
            border: 2px solid #d1d1d1;
            border-radius: 25px;
            background: white;
            color: #666;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.3s;
            min-width: 80px;
            text-align: center;
            margin-right: 8px;
        }

        .oval-toggle.active {
            background: var(--color-brand);
            border-color: var(--color-brand);
            color: white;
        }

        .oval-toggle.elb.active {
            background: #d13438;
            border-color: #d13438;
            color: white;
        }

        .btn {
            padding: 6px 12px;
            border: 1px solid #d1d1d1;
            border-radius: 2px;
            background: white;
            color: var(--color-text);
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s ease;
        }

        .btn:hover {
            background: #f3f2f1;
        }

        .btn-primary {
            background: var(--color-brand);
            color: white;
            border-color: var(--color-brand);
        }

        .btn-primary:hover {
            background: var(--color-brand-strong);
        }

        .item-list {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid var(--color-border);
            border-radius: 4px;
            background: white;
        }

        .item {
            padding: 8px 12px;
            border-bottom: 1px solid #f3f2f1;
            font-size: 14px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .item:last-child {
            border-bottom: none;
        }

        .item:hover {
            background: #f9f9f9;
        }

        .item-list-empty {
            padding: 20px;
            text-align: center;
            color: #999;
            font-style: italic;
        }

        .generate-estimate-section {
            padding: 20px;
            text-align: center;
            border-top: 1px solid var(--color-border);
            background: #f9f9f9;
        }

        .generate-estimate-btn {
            padding: 12px 32px;
            font-size: 15px;
            font-weight: 600;
            background: var(--color-brand);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(16, 163, 127, 0.3);
        }

        .generate-estimate-btn:hover {
            background: var(--color-brand-strong);
            transform: translateY(-2px);
            box-shadow: 0 6px 18px rgba(16, 163, 127, 0.4);
        }

        .center-generate-button {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--color-brand) 0%, #0E8F71 100%);
            color: white;
            border: none;
            cursor: pointer;
            font-size: 18px;
            font-weight: 700;
            box-shadow:
                0 8px 32px rgba(16, 163, 127, 0.4),
                inset 0 2px 8px rgba(255, 255, 255, 0.2),
                inset 0 -2px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 8px;
            animation: pulse-glow 3s ease-in-out infinite;
            margin: 0 auto;
        }

        @keyframes pulse-glow {
            0%, 100% {
                transform: scale(1);
                box-shadow:
                    0 8px 32px rgba(16, 163, 127, 0.4),
                    inset 0 2px 8px rgba(255, 255, 255, 0.2),
                    inset 0 -2px 8px rgba(0, 0, 0, 0.1);
            }
            50% {
                transform: scale(1.02);
                box-shadow:
                    0 12px 40px rgba(16, 163, 127, 0.5),
                    inset 0 2px 8px rgba(255, 255, 255, 0.25),
                    inset 0 -2px 8px rgba(0, 0, 0, 0.15);
            }
        }

        .center-generate-button:hover {
            transform: scale(1.05);
            box-shadow:
                0 12px 40px rgba(16, 163, 127, 0.6),
                inset 0 3px 12px rgba(255, 255, 255, 0.3),
                inset 0 -3px 12px rgba(0, 0, 0, 0.2);
        }

        .estimate-table {
            border: 1px solid var(--color-border);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--color-border);
        }

        th {
            background: #f9f9f9;
            font-weight: 600;
            font-size: 14px;
            color: var(--color-text);
        }

        td {
            font-size: 14px;
            color: var(--color-text);
        }

        .text-right { text-align: right; }
        .text-center { text-align: center; }

        /* AI Chat */
        .ai-chat-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 56px;
            height: 56px;
            background: var(--color-brand);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            box-shadow: 0 4px 16px rgba(16, 163, 127, 0.4);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .ai-chat-button:hover {
            background: var(--color-brand-strong);
            transform: scale(1.05) translateY(-1px);
            box-shadow: 0 6px 20px rgba(16, 163, 127, 0.5);
        }

        .ai-chat-popup {
            position: fixed;
            width: 520px;
            height: 650px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            display: none;
            flex-direction: column;
            z-index: 999999;
            min-width: 390px;
            min-height: 520px;
            border: 3px solid var(--color-brand);
        }

        .ai-chat-popup.visible {
            display: flex;
        }

        .ai-chat-header {
            background: var(--color-brand);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: move;
            user-select: none;
        }

        .ai-chat-title {
            font-weight: 600;
            font-size: 16px;
        }

        .ai-chat-close {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 18px;
            padding: 0;
            width: 24px;
            height: 24px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .ai-chat-close:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .ai-chat-body {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            border-bottom: 1px solid var(--color-border);
        }

        .ai-chat-messages {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 15px;
        }

        .ai-message, .user-message {
            padding: 12px 16px;
            border-radius: 8px;
            max-width: 80%;
            word-wrap: break-word;
        }

        .ai-message {
            background: #f9f9f9;
            color: var(--color-text);
            align-self: flex-start;
        }

        .user-message {
            background: var(--color-brand);
            color: white;
            align-self: flex-end;
        }

        .ai-chat-file-area {
            border: 2px dashed #d1d1d1;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .ai-chat-file-area:hover,
        .ai-chat-file-area.dragover {
            border-color: var(--color-brand);
            background: #f0f9f6;
        }

        .ai-chat-input-area {
            padding: 15px 20px;
            border-top: 1px solid var(--color-border);
            background: white;
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }

        .ai-chat-input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #d1d1d1;
            border-radius: 4px;
            resize: none;
            min-height: 40px;
            max-height: 120px;
            font-family: inherit;
            font-size: 14px;
        }

        .ai-send-button {
            padding: 8px 16px;
            background: var(--color-brand);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .ai-send-button:hover {
            background: var(--color-brand-strong);
        }

        /* Popup Overlay */
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }

        .popup-content {
            background: white;
            border-radius: 8px;
            padding: 24px;
            min-width: 400px;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .popup-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--color-border);
        }

        .popup-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--color-text);
        }

        .popup-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
        }

        .popup-close:hover {
            background: #f3f2f1;
        }

        .popup-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 24px;
            padding-top: 20px;
            border-top: 1px solid var(--color-border);
        }

        .popup-btn {
            padding: 10px 20px;
            border: 1px solid #d1d1d1;
            border-radius: 4px;
            background: white;
            color: var(--color-text);
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
        }

        .popup-btn:hover {
            background: #f3f2f1;
        }

        .popup-btn.primary {
            background: var(--color-brand);
            color: white;
            border-color: var(--color-brand);
        }

        .popup-btn.primary:hover {
            background: var(--color-brand-strong);
        }

        /* Utility classes */
        .hidden { display: none !important; }
        .visible { display: block !important; }
        .flex { display: flex; }
        .flex-column { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-center { justify-content: center; }
        .gap-2 { gap: 8px; }
        .gap-3 { gap: 12px; }
        .mb-4 { margin-bottom: 16px; }
        .p-4 { padding: 16px; }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                width: 80px;
            }
            .sidebar-title,
            .sidebar-section-title,
            .sidebar-nav-item-text,
            .sidebar-account-info {
                display: none;
            }
            .quote-left-panel {
                width: 100%;
            }
            .quote-content {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <div id="sidebar" class="sidebar">
            <!-- Header -->
            <div class="sidebar-header">
                <h2 class="sidebar-title">(Ï£º)ÌïúÍµ≠ÏÇ∞ÏóÖ</h2>
                <button id="sidebarToggle" class="btn" style="border: none; background: none; padding: 4px;">
                    <i data-lucide="menu" style="width: 20px; height: 20px;"></i>
                </button>
            </div>

            <!-- Content -->
            <div class="sidebar-content">
                <!-- New Chat Button -->
                <button id="newChatBtn" class="sidebar-button">
                    <i data-lucide="plus" style="width: 20px; height: 20px;"></i>
                    <span class="sidebar-button-text">ÏÉà Ï±ÑÌåÖ</span>
                </button>

                <!-- Recent Chats -->
                <div class="sidebar-section">
                    <div class="sidebar-section-title">ÏµúÍ∑º ÎåÄÌôî</div>
                    <button class="sidebar-chat-item">
                        <i data-lucide="message-square" style="width: 16px; height: 16px;"></i>
                        <span>ÌîÑÎ°úÏ†ùÌä∏ ÏùºÏ†ï Í¥ÄÎ¶¨</span>
                    </button>
                    <button class="sidebar-chat-item">
                        <i data-lucide="message-square" style="width: 16px; height: 16px;"></i>
                        <span>Í≤¨Ï†ÅÏÑú ÏûëÏÑ± ÎèÑÏõÄ</span>
                    </button>
                    <button class="sidebar-chat-item">
                        <i data-lucide="message-square" style="width: 16px; height: 16px;"></i>
                        <span>ERP ÏãúÏä§ÌÖú ÏßàÎ¨∏</span>
                    </button>
                </div>

                <!-- Navigation -->
                <div class="sidebar-section">
                    <div class="sidebar-section-title">ÏóÖÎ¨¥</div>
                    <button class="sidebar-nav-item active" data-view="hero">
                        <i data-lucide="briefcase" style="width: 20px; height: 20px;"></i>
                        <span class="sidebar-nav-item-text">AIÎß§ÎãàÏ†Ä</span>
                    </button>
                    <button class="sidebar-nav-item" data-view="quote">
                        <i data-lucide="receipt" style="width: 20px; height: 20px;"></i>
                        <span class="sidebar-nav-item-text">Í≤¨Ï†Å</span>
                    </button>
                    <button class="sidebar-nav-item" data-view="erp">
                        <i data-lucide="grid-3-x-3" style="width: 20px; height: 20px;"></i>
                        <span class="sidebar-nav-item-text">ERP</span>
                    </button>
                    <button class="sidebar-nav-item">
                        <i data-lucide="calendar" style="width: 20px; height: 20px;"></i>
                        <span class="sidebar-nav-item-text">Ï∫òÎ¶∞Îçî</span>
                    </button>
                    <button class="sidebar-nav-item">
                        <i data-lucide="mail" style="width: 20px; height: 20px;"></i>
                        <span class="sidebar-nav-item-text">Ïù¥Î©îÏùº</span>
                    </button>
                    <button class="sidebar-nav-item">
                        <i data-lucide="layers" style="width: 20px; height: 20px;"></i>
                        <span class="sidebar-nav-item-text">ÎèÑÎ©¥</span>
                    </button>
                </div>

                <!-- New Project Section -->
                <div class="sidebar-section">
                    <div class="sidebar-section-title">ÏÉà ÌîÑÎ°úÏ†ùÌä∏</div>
                    <button class="sidebar-button" style="background: white; color: var(--color-text); border: 1px solid var(--color-border);">
                        <i data-lucide="folder-plus" style="width: 20px; height: 20px;"></i>
                        <span class="sidebar-button-text">ÏÉà ÌîÑÎ°úÏ†ùÌä∏</span>
                    </button>
                    <button class="sidebar-chat-item">
                        <i data-lucide="folder" style="width: 16px; height: 16px;"></i>
                        <span>AÏÇ¨ Ïã†Í∑ú ÌîÑÎ°úÏ†ùÌä∏</span>
                    </button>
                    <button class="sidebar-chat-item">
                        <i data-lucide="folder" style="width: 16px; height: 16px;"></i>
                        <span>BÏÇ¨ Í≤¨Ï†Å Í¥ÄÎ¶¨</span>
                    </button>
                </div>
            </div>

            <!-- Account Menu -->
            <div class="sidebar-account">
                <div class="account-avatar">ÎÇ¥</div>
                <div class="sidebar-account-info">
                    <div style="font-size: 16px; line-height: 1.2; color: var(--color-text);">ÎÇ¥ Í≥ÑÏ†ï</div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Hero Section -->
            <div id="heroView" class="hero-section">
                <div class="hero-content">
                    <h1 class="hero-title">(Ï£º)ÌïúÍµ≠ÏÇ∞ÏóÖ</h1>
                    <p class="hero-subtitle">Î¨¥ÏóáÏùÑ ÎèÑÏôÄÎìúÎ¶¥ÍπåÏöî?</p>

                    <div class="hero-input-container">
                        <button style="background: none; border: none; padding: 8px;">
                            <i data-lucide="plus" style="width: 20px; height: 20px; color: var(--color-text-subtle);"></i>
                        </button>
                        <input id="heroInput" class="hero-input" placeholder="Î©îÏãúÏßÄÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî‚Ä¶(EnterÎ°ú Ï†ÑÏÜ°)" />
                        <button id="heroSendBtn" class="hero-send-button">
                            <i data-lucide="send" style="width: 16px; height: 16px;"></i>
                        </button>
                    </div>

                    <div class="prompt-chips">
                        <button class="prompt-chip">ÌîÑÎ°úÏ†ùÌä∏ ÏùºÏ†ï Í¥ÄÎ¶¨</button>
                        <button class="prompt-chip">Í≤¨Ï†ÅÏÑú ÏûëÏÑ± ÎèÑÏõÄ</button>
                        <button class="prompt-chip">ERP ÏãúÏä§ÌÖú ÏßàÎ¨∏</button>
                        <button class="prompt-chip">ÏóÖÎ¨¥ ÏûêÎèôÌôî</button>
                        <button class="prompt-chip">Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù</button>
                        <button class="prompt-chip">ÌíàÏßà Í¥ÄÎ¶¨</button>
                    </div>
                </div>
            </div>

            <!-- Chat View -->
            <div id="chatView" class="chat-view hidden">
                <div class="chat-header">
                    <h2 class="h2-20">AI Îß§ÎãàÏ†Ä</h2>
                    <div style="display: flex; gap: 8px;">
                        <button class="btn">
                            <i data-lucide="share-2" style="width: 16px; height: 16px; margin-right: 4px;"></i>
                            Í≥µÏú†
                        </button>
                        <button class="btn">
                            <i data-lucide="file-text" style="width: 16px; height: 16px; margin-right: 4px;"></i>
                            Ïª®ÌÖêÏ∏†
                        </button>
                    </div>
                </div>

                <div class="chat-container">
                    <div class="chat-messages">
                        <div class="date-divider">Ïò§Îäò - 2025ÎÖÑ 9Ïõî 25Ïùº</div>
                        <div id="messagesList"></div>
                        <div id="typingIndicator" class="message ai hidden">
                            <div class="message-avatar">ü§ñ</div>
                            <div class="typing-indicator">
                                <div class="typing-dot"></div>
                                <div class="typing-dot"></div>
                                <div class="typing-dot"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Chat Input -->
                <div style="padding: 24px; background: var(--color-bg);">
                    <div style="max-width: 1000px; margin: 0 auto;">
                        <div style="background: var(--color-surface); border: 1px solid var(--color-border); border-radius: var(--radius-lg); padding: 16px; display: flex; align-items: end; gap: 12px;">
                            <button style="background: none; border: none; padding: 8px;">
                                <i data-lucide="plus" style="width: 20px; height: 20px; color: var(--color-text-subtle);"></i>
                            </button>
                            <textarea id="chatInput" placeholder="Î©îÏãúÏßÄÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî‚Ä¶(EnterÎ°ú Ï†ÑÏÜ°)" style="flex: 1; background: transparent; border: none; outline: none; resize: none; font-family: inherit; font-size: 16px; color: var(--color-text); min-height: 24px; max-height: 96px;" rows="1"></textarea>
                            <button id="chatSendBtn" class="hero-send-button">
                                <i data-lucide="send" style="width: 16px; height: 16px;"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quote System -->
            <div id="quoteView" class="quote-system hidden">
                <!-- Tabs -->
                <div class="quote-tabs">
                    <div id="quoteTabs">
                        <div class="quote-tab active" data-tab="1">
                            Í≤¨Ï†ÅÏÑú 1
                            <span class="tab-close">√ó</span>
                        </div>
                    </div>
                    <button id="addTabBtn" class="new-tab">+ ÏÉà ÌÉ≠</button>
                </div>

                <!-- Content -->
                <div class="quote-content">
                    <!-- Left Panel -->
                    <div class="quote-left-panel">
                        <!-- Í≥†Í∞ùÏ†ïÎ≥¥ -->
                        <div class="quote-section">
                            <div class="quote-section-header">
                                <span>Í≥†Í∞ùÏ†ïÎ≥¥</span>
                            </div>
                            <div class="quote-section-content">
                                <div class="form-grid-2x2">
                                    <div class="form-row">
                                        <label class="form-label">ÏóÖÏ≤¥Î™Ö</label>
                                        <input type="text" class="form-input" id="companyName" placeholder="ÏóÖÏ≤¥Î™ÖÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
                                    </div>
                                    <div class="form-row">
                                        <label class="form-label">Ïó∞ÎùΩÏ≤ò</label>
                                        <input type="text" class="form-input" id="contact" placeholder="Ïó∞ÎùΩÏ≤òÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
                                    </div>
                                    <div class="form-row">
                                        <label class="form-label">Ïù¥Î©îÏùº</label>
                                        <input type="email" class="form-input" id="email" placeholder="Ïù¥Î©îÏùºÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
                                    </div>
                                    <div class="form-row">
                                        <label class="form-label">Ï£ºÏÜå</label>
                                        <input type="text" class="form-input" id="address" placeholder="Ï£ºÏÜåÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Ïô∏Ìï®Ï†ïÎ≥¥ -->
                        <div class="quote-section">
                            <div class="quote-section-header">
                                <span>Ïô∏Ìï®Ï†ïÎ≥¥</span>
                                <div class="toggle-container">
                                    <button class="toggle-option active" data-type="Ïò•ÎÇ¥">Ïò•ÎÇ¥</button>
                                    <button class="toggle-option" data-type="Ïò•Ïô∏">Ïò•Ïô∏</button>
                                </div>
                            </div>
                            <div class="quote-section-content">
                                <div class="form-grid-2x2" style="grid-template-columns: 1fr 1fr;">
                                    <div class="form-row">
                                        <label class="form-label">Ìï®Ï≤¥ÌÉÄÏûÖ</label>
                                        <select class="form-select" id="boxType">
                                            <option value="">ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
                                            <option value="Í∏∞ÏÑ±Ìï®">Í∏∞ÏÑ±Ìï®</option>
                                            <option value="Ï†úÏûëÌï®">Ï†úÏûëÌï®</option>
                                        </select>
                                    </div>
                                    <div class="form-row">
                                        <label class="form-label">Ïû¨Ïßà</label>
                                        <select class="form-select" id="material">
                                            <option value="">ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
                                            <option value="STEEL 1.6T">STEEL 1.6T</option>
                                            <option value="STEEL 2.0T">STEEL 2.0T</option>
                                            <option value="STS 1.5T">STS 1.5T</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <label class="form-label">ÌäπÏù¥ÏÇ¨Ìï≠</label>
                                    <input type="text" class="form-input" id="specialRequest" placeholder="ÌäπÏù¥ÏÇ¨Ìï≠ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
                                </div>
                            </div>
                        </div>

                        <!-- Î©îÏù∏ Ï∞®Îã®Í∏∞ -->
                        <div class="quote-section">
                            <div class="quote-section-header">
                                <span>Î©îÏù∏ Ï∞®Îã®Í∏∞</span>
                                <button id="breakerSettingsBtn" class="btn btn-primary">Ï∞®Îã®Í∏∞ ÏÑ§Ï†ï</button>
                            </div>
                            <div class="quote-section-content">
                                <div style="display: flex; gap: 20px; align-items: start;">
                                    <div style="display: flex; flex-direction: column; gap: 6px;">
                                        <button class="oval-toggle active" data-breaker="MCCB">MCCB</button>
                                        <button class="oval-toggle elb" data-breaker="ELB">ELB</button>
                                    </div>

                                    <div style="flex: 1;">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                                            <div class="form-row">
                                                <label class="form-label">Í∑πÏàò</label>
                                                <select class="form-select" id="mainPoles">
                                                    <option value="">ÏÑ†ÌÉù</option>
                                                    <option value="2P">2P</option>
                                                    <option value="3P">3P</option>
                                                    <option value="4P">4P</option>
                                                </select>
                                            </div>
                                            <div class="form-row">
                                                <label class="form-label">Ïö©Îüâ</label>
                                                <select class="form-select" id="mainCapacity">
                                                    <option value="">ÏÑ†ÌÉù</option>
                                                    <option value="100A">100A</option>
                                                    <option value="125A">125A</option>
                                                    <option value="150A">150A</option>
                                                    <option value="175A">175A</option>
                                                    <option value="200A">200A</option>
                                                    <option value="225A">225A</option>
                                                    <option value="250A">250A</option>
                                                    <option value="300A">300A</option>
                                                    <option value="350A">350A</option>
                                                    <option value="400A">400A</option>
                                                    <option value="500A">500A</option>
                                                    <option value="600A">600A</option>
                                                    <option value="700A">700A</option>
                                                    <option value="800A">800A</option>
                                                    <option value="1000A">1000A</option>
                                                    <option value="1200A">1200A</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Î∂ÑÍ∏∞ Ï∞®Îã®Í∏∞ -->
                        <div class="quote-section">
                            <div class="quote-section-header">
                                <span>Î∂ÑÍ∏∞ Ï∞®Îã®Í∏∞</span>
                            </div>
                            <div class="quote-section-content">
                                <div class="form-row-horizontal">
                                    <div style="width: 60px;">
                                        <label class="form-label">Ï¢ÖÎ•ò</label>
                                        <select class="form-select" id="branchType" style="width: 60px; font-size: 12px; padding: 6px 4px;">
                                            <option value="">ÏÑ†ÌÉù</option>
                                            <option value="MCCB">MCCB</option>
                                            <option value="ELB">ELB</option>
                                        </select>
                                    </div>
                                    <div style="width: 60px;">
                                        <label class="form-label">Í∑πÏàò</label>
                                        <select class="form-select" id="branchPoles" style="width: 60px; font-size: 12px; padding: 6px 4px;">
                                            <option value="">ÏÑ†ÌÉù</option>
                                            <option value="2P">2P</option>
                                            <option value="3P">3P</option>
                                            <option value="4P">4P</option>
                                        </select>
                                    </div>
                                    <div style="width: 60px;">
                                        <label class="form-label">Ïö©Îüâ</label>
                                        <select class="form-select" id="branchCapacity" style="width: 60px; font-size: 12px; padding: 6px 4px;">
                                            <option value="">ÏÑ†ÌÉù</option>
                                            <option value="15A">15A</option>
                                            <option value="20A">20A</option>
                                            <option value="30A">30A</option>
                                            <option value="40A">40A</option>
                                            <option value="50A">50A</option>
                                            <option value="60A">60A</option>
                                            <option value="75A">75A</option>
                                            <option value="100A">100A</option>
                                            <option value="125A">125A</option>
                                            <option value="150A">150A</option>
                                            <option value="175A">175A</option>
                                            <option value="200A">200A</option>
                                            <option value="225A">225A</option>
                                            <option value="250A">250A</option>
                                            <option value="300A">300A</option>
                                            <option value="350A">350A</option>
                                            <option value="400A">400A</option>
                                            <option value="500A">500A</option>
                                            <option value="600A">600A</option>
                                            <option value="700A">700A</option>
                                            <option value="800A">800A</option>
                                            <option value="1000A">1000A</option>
                                            <option value="1200A">1200A</option>
                                        </select>
                                    </div>
                                    <div style="width: 50px;">
                                        <label class="form-label">ÏàòÎüâ</label>
                                        <input type="number" class="form-input" id="branchQuantity" value="1" min="1" max="10" style="width: 50px; font-size: 12px; padding: 6px 4px; text-align: center;">
                                    </div>
                                    <div style="width: 55px;">
                                        <label class="form-label">&nbsp;</label>
                                        <button id="addBranchBtn" class="btn btn-primary" style="width: 55px; height: 32px; font-size: 11px;">ÌôïÏù∏</button>
                                    </div>
                                </div>

                                <div id="branchList" class="item-list">
                                    <div class="item-list-empty">Ï∂îÍ∞ÄÎêú Î∂ÑÍ∏∞ Ï∞®Îã®Í∏∞Í∞Ä ÏóÜÏäµÎãàÎã§</div>
                                </div>
                            </div>
                        </div>

                        <!-- Î∂ÄÏÜçÏûêÏû¨ -->
                        <div class="quote-section">
                            <div class="quote-section-header">
                                <span>Î∂ÄÏÜçÏûêÏû¨</span>
                            </div>
                            <div class="quote-section-content">
                                <!-- ÎßàÍ∑∏ÎÑ§Ìä∏ ÎùºÏù∏ -->
                                <div class="form-row-horizontal" style="margin-bottom: 15px;">
                                    <div style="width: 75px;">
                                        <label class="form-label">ÎßàÍ∑∏ÎÑ§Ìä∏</label>
                                        <select class="form-select" id="magnetModel" style="width: 75px; font-size: 12px; padding: 6px 4px;">
                                            <option value="">ÏÑ†ÌÉù</option>
                                            <option value="MC-9">MC-9</option>
                                            <option value="MC-12">MC-12</option>
                                            <option value="MC-18">MC-18</option>
                                            <option value="MC-22">MC-22</option>
                                            <option value="MC-32">MC-32</option>
                                            <option value="MC-40">MC-40</option>
                                            <option value="MC-50">MC-50</option>
                                            <option value="MC-65">MC-65</option>
                                            <option value="MC-75">MC-75</option>
                                            <option value="MC-85">MC-85</option>
                                            <option value="MC-100">MC-100</option>
                                            <option value="MC-130">MC-130</option>
                                            <option value="MC-150">MC-150</option>
                                        </select>
                                    </div>
                                    <div style="width: 60px;">
                                        <label class="form-label">ÌÉÄÏù¥Î®∏</label>
                                        <select class="form-select" id="magnetTimer" style="width: 60px; font-size: 12px; padding: 6px 4px;">
                                            <option value="">ÏÑ†ÌÉù</option>
                                            <option value="YES">Ìè¨Ìï®</option>
                                            <option value="NO">Ï†úÏô∏</option>
                                        </select>
                                    </div>
                                    <div style="width: 60px;">
                                        <label class="form-label">PBL</label>
                                        <select class="form-select" id="magnetPBL" style="width: 60px; font-size: 12px; padding: 6px 4px;">
                                            <option value="">ÏÑ†ÌÉù</option>
                                            <option value="YES">Ìè¨Ìï®</option>
                                            <option value="NO">Ï†úÏô∏</option>
                                        </select>
                                    </div>
                                    <div style="width: 50px;">
                                        <label class="form-label">ÏàòÎüâ</label>
                                        <input type="number" class="form-input" id="magnetQuantity" value="1" min="1" max="10" style="width: 50px; font-size: 12px; padding: 6px 4px; text-align: center;">
                                    </div>
                                    <div style="width: 55px;">
                                        <label class="form-label">&nbsp;</label>
                                        <button id="addMagnetBtn" class="btn btn-primary" style="width: 55px; height: 32px; font-size: 11px;">ÌôïÏù∏</button>
                                    </div>
                                </div>

                                <!-- Í∏∞ÌÉÄ Î∂ÄÏÜçÏûêÏû¨ ÎùºÏù∏ -->
                                <div class="form-row-horizontal">
                                    <div style="width: 75px;">
                                        <label class="form-label">Î∂ÄÏÜçÏûêÏû¨</label>
                                        <select class="form-select" id="accessoryCategory" style="width: 75px; font-size: 12px; padding: 6px 4px;">
                                            <option value="">ÏÑ†ÌÉù</option>
                                            <option value="meter">Í≥ÑÎüâÍ∏∞</option>
                                            <option value="3ct">3CT</option>
                                            <option value="timer">ÌÉÄÏù¥Î®∏</option>
                                            <option value="eocr">EOCR</option>
                                            <option value="condenser">ÏΩòÎç¥ÏÑú</option>
                                            <option value="etc">Í∏∞ÌÉÄ</option>
                                        </select>
                                    </div>
                                    <div style="width: 75px;">
                                        <label class="form-label">ÏÑ∏Î∂ÄÏÑ†ÌÉù</label>
                                        <select class="form-select" id="accessoryDetail" style="width: 75px; font-size: 12px; padding: 6px 4px;">
                                            <option value="">ÏÑ†ÌÉù</option>
                                        </select>
                                    </div>
                                    <div style="width: 60px;">
                                        <label class="form-label">Í∑úÍ≤©</label>
                                        <select class="form-select" id="accessorySpec" style="width: 60px; font-size: 12px; padding: 6px 4px;">
                                            <option value="">ÏÑ†ÌÉù</option>
                                        </select>
                                    </div>
                                    <div style="width: 50px;">
                                        <label class="form-label">ÏàòÎüâ</label>
                                        <input type="number" class="form-input" id="accessoryQuantity" value="1" min="1" max="10" style="width: 50px; font-size: 12px; padding: 6px 4px; text-align: center;">
                                    </div>
                                    <div style="width: 55px;">
                                        <label class="form-label">&nbsp;</label>
                                        <button id="addAccessoryBtn" class="btn btn-primary" style="width: 55px; height: 32px; font-size: 11px;">ÌôïÏù∏</button>
                                    </div>
                                </div>

                                <div id="accessoryList" class="item-list">
                                    <div class="item-list-empty">Ï∂îÍ∞ÄÎêú Î∂ÄÏÜçÏûêÏû¨Í∞Ä ÏóÜÏäµÎãàÎã§</div>
                                </div>
                            </div>
                        </div>

                        <!-- Í≤¨Ï†Å ÏÉùÏÑ± Î≤ÑÌäº -->
                        <div class="generate-estimate-section">
                            <button id="generateEstimateBtn" class="generate-estimate-btn">Í≤¨Ï†Å ÏÉùÏÑ±</button>
                        </div>
                    </div>

                    <!-- Right Panel -->
                    <div class="quote-right-panel">
                        <!-- KAIZEN ÌîÑÎ°úÏ†ùÌä∏ Ï†ÄÏû• Î≤ÑÌäº -->
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding: 0 20px;">
                            <h3 style="margin: 0; font-size: 18px; font-weight: 600;">Í≤¨Ï†Å Í≤∞Í≥º</h3>
                            <button id="saveProjectBtn" style="
                                background: var(--color-brand);
                                color: white;
                                border: none;
                                padding: 10px 20px;
                                border-radius: var(--radius-md);
                                font-size: 14px;
                                font-weight: 600;
                                cursor: pointer;
                                transition: all 0.2s ease;
                                display: flex;
                                align-items: center;
                                gap: 8px;
                            " onmouseover="this.style.background='var(--color-brand-strong)'" onmouseout="this.style.background='var(--color-brand)'">
                                <i data-lucide="save" style="width: 16px; height: 16px;"></i>
                                ÌîÑÎ°úÏ†ùÌä∏ Ï†ÄÏû•
                            </button>
                        </div>

                        <div id="estimateEmpty" style="display: flex; flex-direction: column; align-items: center; justify-content: center; flex: 1; min-height: 400px;">
                            <button class="center-generate-button" onclick="generateEstimate()">
                                <div style="font-size: 32px; margin-bottom: 8px;">üìã</div>
                                <div style="font-size: 16px; font-weight: 600;">Í≤¨Ï†Å ÏÉùÏÑ±</div>
                            </button>
                            <p style="margin-top: 24px; color: #666; text-align: center; font-size: 14px;">
                                Ï¢åÏ∏°ÏóêÏÑú ÌïÑÏöîÌïú Ï†ïÎ≥¥Î•º ÏûÖÎ†•Ìïú ÌõÑ<br />
                                Í≤¨Ï†Å ÏÉùÏÑ± Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠ÌïòÏÑ∏Ïöî
                            </p>
                        </div>

                        <div id="estimateResult" class="hidden">
                            <!-- Í≤¨Ï†Å Ìó§Îçî -->
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; background: #f9f9f9; border-radius: 4px; margin-bottom: 15px;">
                                <div style="font-size: 16px; font-weight: 600; color: var(--color-text);">Í≤¨Ï†ÅÏÑú</div>
                                <div style="font-size: 16px; font-weight: 600; color: var(--color-brand);" id="totalAmount">Ï¥ùÏï°: 2,450,000Ïõê</div>
                            </div>

                            <!-- Í≤¨Ï†Å ÌÖåÏù¥Î∏î -->
                            <div class="estimate-table">
                                <table id="estimateTable">
                                    <thead>
                                        <tr>
                                            <th>Ìï≠Î™©</th>
                                            <th class="text-center">ÏàòÎüâ</th>
                                            <th class="text-right">Îã®Í∞Ä</th>
                                            <th class="text-right">Í∏àÏï°</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Í≤¨Ï†Å Ìï≠Î™©Îì§Ïù¥ ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê® -->
                                    </tbody>
                                </table>
                            </div>

                            <!-- ÌïòÎã® Î≤ÑÌäº -->
                            <div style="display: flex; gap: 10px; margin-top: 15px;">
                                <button class="btn">PDF Îã§Ïö¥Î°úÎìú</button>
                                <button class="btn">Excel Îã§Ïö¥Î°úÎìú</button>
                                <button class="btn btn-primary">Í≤¨Ï†ÅÏÑú Ï†ÑÏÜ°</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ERP View -->
            <div id="erpView" class="hidden" style="padding: 24px; background: var(--color-surface); height: 100vh; overflow-y: auto;">
                <div style="max-width: 1200px; margin: 0 auto;">
                    <div style="margin-bottom: 24px;">
                        <h2 style="font-size: 32px; font-weight: 600; color: var(--color-text-strong); margin-bottom: 8px;">ERP ÏãúÏä§ÌÖú</h2>
                        <p style="color: var(--color-text-subtle); font-size: 16px;">ÌÜµÌï© Í∏∞ÏóÖ ÏûêÏõê Í¥ÄÎ¶¨ ÏãúÏä§ÌÖú</p>
                    </div>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 24px; margin-bottom: 32px;">
                        <div style="background: white; padding: 24px; border-radius: var(--radius-lg); border: 1px solid var(--color-border);">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                                <div>
                                    <p style="font-size: 14px; color: var(--color-text-subtle); margin-bottom: 4px;">Ï¥ù Îß§Ï∂ú</p>
                                    <p style="font-size: 32px; font-weight: 600; color: var(--color-text-strong);">‚Ç©42Ïñµ</p>
                                </div>
                                <div style="width: 48px; height: 48px; background: #dcfce7; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                    <i data-lucide="trending-up" style="width: 24px; height: 24px; color: #16a34a;"></i>
                                </div>
                            </div>
                            <p style="font-size: 12px; color: #16a34a;">+12% Ï†ÑÏõî ÎåÄÎπÑ</p>
                        </div>

                        <div style="background: white; padding: 24px; border-radius: var(--radius-lg); border: 1px solid var(--color-border);">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                                <div>
                                    <p style="font-size: 14px; color: var(--color-text-subtle); margin-bottom: 4px;">ÏßÑÌñâ ÌîÑÎ°úÏ†ùÌä∏</p>
                                    <p style="font-size: 32px; font-weight: 600; color: var(--color-text-strong);">18Í∞ú</p>
                                </div>
                                <div style="width: 48px; height: 48px; background: #dbeafe; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                    <i data-lucide="folder" style="width: 24px; height: 24px; color: #2563eb;"></i>
                                </div>
                            </div>
                            <p style="font-size: 12px; color: #2563eb;">+3Í∞ú Ïã†Í∑ú</p>
                        </div>

                        <div style="background: white; padding: 24px; border-radius: var(--radius-lg); border: 1px solid var(--color-border);">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                                <div>
                                    <p style="font-size: 14px; color: var(--color-text-subtle); margin-bottom: 4px;">ÎåÄÍ∏∞ Í≤¨Ï†Å</p>
                                    <p style="font-size: 32px; font-weight: 600; color: var(--color-text-strong);">7Í∞ú</p>
                                </div>
                                <div style="width: 48px; height: 48px; background: #fed7aa; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                    <i data-lucide="file-text" style="width: 24px; height: 24px; color: #ea580c;"></i>
                                </div>
                            </div>
                            <p style="font-size: 12px; color: #ea580c;">Í≤ÄÌÜ† ÌïÑÏöî</p>
                        </div>

                        <div style="background: white; padding: 24px; border-radius: var(--radius-lg); border: 1px solid var(--color-border);">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                                <div>
                                    <p style="font-size: 14px; color: var(--color-text-subtle); margin-bottom: 4px;">ÌåÄ Íµ¨ÏÑ±Ïõê</p>
                                    <p style="font-size: 32px; font-weight: 600; color: var(--color-text-strong);">24Î™Ö</p>
                                </div>
                                <div style="width: 48px; height: 48px; background: #f3e8ff; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                    <i data-lucide="users" style="width: 24px; height: 24px; color: #9333ea;"></i>
                                </div>
                            </div>
                            <p style="font-size: 12px; color: #9333ea;">ÌôúÏÑ± ÏÇ¨Ïö©Ïûê</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- AI Chat Button -->
    <button id="aiChatBtn" class="ai-chat-button">ü§ñ</button>

    <!-- AI Chat Popup -->
    <div id="aiChatPopup" class="ai-chat-popup" style="left: 50%; top: 50%; transform: translate(-50%, -50%);">
        <div class="ai-chat-header" id="aiChatHeader">
            <div class="ai-chat-title">AI Í≤¨Ï†Å ÎèÑÏö∞ÎØ∏</div>
            <button class="ai-chat-close" id="aiChatClose">√ó</button>
        </div>

        <div class="ai-chat-body">
            <div class="ai-chat-messages" id="aiChatMessages">
                <div class="ai-message">
                    ÏïàÎÖïÌïòÏÑ∏Ïöî! ÎèÑÎ©¥Ïù¥ÎÇò ÏûêÎ£åÎ•º ÏóÖÎ°úÎìúÌïòÏãúÎ©¥ ÏûêÎèôÏúºÎ°ú Í≤¨Ï†ÅÏùÑ ÏÉùÏÑ±Ìï¥ÎìúÎ¶ΩÎãàÎã§. Í≤¨Ï†Å Í¥ÄÎ†® Í∂ÅÍ∏àÌïú Í≤ÉÏù¥ ÏûàÏúºÏãúÎ©¥ Ïñ∏Ï†úÎì† Î¨ºÏñ¥Î≥¥ÏÑ∏Ïöî.
                </div>
            </div>

            <div class="ai-chat-file-area" id="aiFileArea">
                <div>üìÅ ÎèÑÎ©¥Ïù¥ÎÇò ÏûêÎ£åÎ•º ÏóÖÎ°úÎìúÌïòÏÑ∏Ïöî</div>
                <input type="file" id="aiFileInput" style="display: none;" multiple accept=".pdf,.jpg,.jpeg,.png,.dwg">
            </div>

            <div id="aiFileList" class="hidden"></div>
        </div>

        <div class="ai-chat-input-area">
            <textarea id="aiChatInput" class="ai-chat-input" placeholder="Í≤¨Ï†Å Í¥ÄÎ†® ÏßàÎ¨∏ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî..."></textarea>
            <button id="aiSendBtn" class="ai-send-button">Ï†ÑÏÜ°</button>
        </div>
    </div>

    <!-- Breaker Settings Popup -->
    <div id="breakerSettingsPopup" class="popup-overlay hidden">
        <div class="popup-content">
            <div class="popup-header">
                <div class="popup-title">Ï∞®Îã®Í∏∞ ÏÑ§Ï†ï</div>
                <button class="popup-close" id="closeBreakerSettings">√ó</button>
            </div>

            <div>
                <p>Ï∞®Îã®Í∏∞ Î∏åÎûúÎìúÎ≥Ñ ÏÑ∏Î∂Ä ÏÑ§Ï†ïÏùÑ Ìï† Ïàò ÏûàÏäµÎãàÎã§.</p>
                <div class="form-row">
                    <label class="form-label">Î©îÏù∏ Ï∞®Îã®Í∏∞ Î∏åÎûúÎìú</label>
                    <select class="form-select" id="mainBreakerBrand">
                        <option value="">ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
                        <option value="ÏÉÅÎèÑÏ∞®Îã®Í∏∞">ÏÉÅÎèÑÏ∞®Îã®Í∏∞</option>
                        <option value="LSÏÇ∞Ï†Ñ">LSÏÇ∞Ï†Ñ</option>
                        <option value="ÎåÄÎ•ôÏ∞®Îã®Í∏∞">ÎåÄÎ•ôÏ∞®Îã®Í∏∞</option>
                        <option value="ÎπÑÏ∏†Î°ú">ÎπÑÏ∏†Î°ú</option>
                    </select>
                </div>
                <div class="form-row">
                    <label class="form-label">Î∂ÑÍ∏∞ Ï∞®Îã®Í∏∞ Í∏∞Î≥∏ Î∏åÎûúÎìú</label>
                    <select class="form-select">
                        <option value="">ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
                        <option value="ÏÉÅÎèÑÏ∞®Îã®Í∏∞">ÏÉÅÎèÑÏ∞®Îã®Í∏∞</option>
                        <option value="LSÏÇ∞Ï†Ñ">LSÏÇ∞Ï†Ñ</option>
                        <option value="ÎåÄÎ•ôÏ∞®Îã®Í∏∞">ÎåÄÎ•ôÏ∞®Îã®Í∏∞</option>
                        <option value="ÎπÑÏ∏†Î°ú">ÎπÑÏ∏†Î°ú</option>
                    </select>
                </div>
                <div class="form-row">
                    <label class="form-label">Î∂ÄÏÜçÏûêÏû¨ Í∏∞Î≥∏ Î∏åÎûúÎìú</label>
                    <select class="form-select">
                        <option value="">ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
                        <option value="ÌïúÍµ≠ÏÇ∞ÏóÖ">ÌïúÍµ≠ÏÇ∞ÏóÖ</option>
                        <option value="ÏÇºÏÑ±">ÏÇºÏÑ±</option>
                        <option value="LG">LG</option>
                        <option value="Í∏∞ÌÉÄ">Í∏∞ÌÉÄ</option>
                    </select>
                </div>
            </div>

            <div class="popup-actions">
                <button class="popup-btn" id="cancelBreakerSettings">Ï∑®ÏÜå</button>
                <button class="popup-btn primary" id="saveBreakerSettings">Ï†ÄÏû•</button>
            </div>
        </div>
    </div>

    <script src="public/js/kaizen-estimator.js"></script>
    <script>
        // Global State
        let currentView = 'hero';
        let sidebarCollapsed = false;
        let messages = [];
        let isTyping = false;
        let aiChatVisible = false;

        // Quote System State
        let tabs = [{
            id: 1,
            title: 'Í≤¨Ï†ÅÏÑú 1',
            customerInfo: { company: '', contact: '', email: '', address: '' },
            enclosureInfo: { type: 'Ïò•ÎÇ¥', boxType: '', material: '', request: '' },
            mainBreakerInfo: { type: 'MCCB', poles: '', capacity: '', brand: '' },
            branchBreakers: [],
            accessories: [],
            estimateVisible: false
        }];
        let activeTabId = 1;
        let nextTabId = 2;
        let branchBreakers = [];
        let accessories = [];
        let customerInfo = { company: '', contact: '', email: '', address: '' };
        let enclosureInfo = { type: 'Ïò•ÎÇ¥', boxType: '', material: '', request: '' };
        let mainBreakerInfo = { type: 'MCCB', poles: '', capacity: '', brand: '' };
        let estimateVisible = false;
        let aiMessages = [];
        let aiFiles = [];

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            lucide.createIcons();
            initializeEventListeners();
            updateAccessoryOptions();
        });

        function initializeEventListeners() {
            // Sidebar
            document.getElementById('sidebarToggle').addEventListener('click', toggleSidebar);
            document.getElementById('newChatBtn').addEventListener('click', () => switchView('chat'));

            // Navigation
            document.querySelectorAll('.sidebar-nav-item').forEach(item => {
                item.addEventListener('click', () => {
                    const view = item.getAttribute('data-view');
                    if (view) switchView(view);
                    setActiveNavItem(item);
                });
            });

            // Hero
            document.getElementById('heroSendBtn').addEventListener('click', sendFromHero);
            document.getElementById('heroInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') sendFromHero();
            });

            // Chat
            document.getElementById('chatSendBtn').addEventListener('click', sendChatMessage);
            document.getElementById('chatInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendChatMessage();
                }
            });

            // Prompt chips
            document.querySelectorAll('.prompt-chip').forEach(chip => {
                chip.addEventListener('click', () => {
                    document.getElementById('heroInput').value = chip.textContent;
                    sendFromHero();
                });
            });

            // Quote System
            setupQuoteSystemListeners();

            // AI Chat
            document.getElementById('aiChatBtn').addEventListener('click', toggleAiChat);
            document.getElementById('aiChatClose').addEventListener('click', toggleAiChat);
            document.getElementById('aiSendBtn').addEventListener('click', sendAiMessage);
            document.getElementById('aiChatInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendAiMessage();
                }
            });
            document.getElementById('aiFileArea').addEventListener('click', () => {
                document.getElementById('aiFileInput').click();
            });
            document.getElementById('aiFileInput').addEventListener('change', handleAiFileSelect);
        }

        function setupQuoteSystemListeners() {
            // Toggle buttons
            document.querySelectorAll('.toggle-option').forEach(btn => {
                btn.addEventListener('click', function() {
                    const parent = this.parentNode;
                    parent.querySelectorAll('.toggle-option').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');

                    const type = this.getAttribute('data-type');
                    if (type) {
                        enclosureInfo.type = type;
                    }
                });
            });

            // Breaker toggles
            document.querySelectorAll('.oval-toggle').forEach(btn => {
                btn.addEventListener('click', function() {
                    const breakerType = this.getAttribute('data-breaker');
                    if (breakerType) {
                        document.querySelectorAll('.oval-toggle').forEach(b => b.classList.remove('active'));
                        this.classList.add('active');
                        mainBreakerInfo.type = breakerType;
                    }
                });
            });

            // Form inputs
            document.getElementById('companyName').addEventListener('input', (e) => customerInfo.company = e.target.value);
            document.getElementById('contact').addEventListener('input', (e) => customerInfo.contact = e.target.value);
            document.getElementById('email').addEventListener('input', (e) => customerInfo.email = e.target.value);
            document.getElementById('address').addEventListener('input', (e) => customerInfo.address = e.target.value);

            document.getElementById('boxType').addEventListener('change', (e) => enclosureInfo.boxType = e.target.value);
            document.getElementById('material').addEventListener('change', (e) => enclosureInfo.material = e.target.value);
            document.getElementById('specialRequest').addEventListener('input', (e) => enclosureInfo.request = e.target.value);

            document.getElementById('mainPoles').addEventListener('change', (e) => mainBreakerInfo.poles = e.target.value);
            document.getElementById('mainCapacity').addEventListener('change', (e) => mainBreakerInfo.capacity = e.target.value);

            // Add buttons
            document.getElementById('addBranchBtn').addEventListener('click', addBranchBreaker);
            document.getElementById('addMagnetBtn').addEventListener('click', addMagnetItem);
            document.getElementById('addAccessoryBtn').addEventListener('click', addAccessoryItem);
            document.getElementById('generateEstimateBtn').addEventListener('click', generateEstimate);

            // Accessory category change
            document.getElementById('accessoryCategory').addEventListener('change', updateAccessoryOptions);
            document.getElementById('accessoryDetail').addEventListener('change', updateAccessorySpecs);

            // Tab system
            document.getElementById('addTabBtn').addEventListener('click', addNewTab);

            // Breaker settings
            document.getElementById('breakerSettingsBtn').addEventListener('click', () => {
                document.getElementById('breakerSettingsPopup').classList.remove('hidden');
            });
            document.getElementById('closeBreakerSettings').addEventListener('click', () => {
                document.getElementById('breakerSettingsPopup').classList.add('hidden');
            });
            document.getElementById('cancelBreakerSettings').addEventListener('click', () => {
                document.getElementById('breakerSettingsPopup').classList.add('hidden');
            });
            document.getElementById('saveBreakerSettings').addEventListener('click', () => {
                alert('Ï∞®Îã®Í∏∞ ÏÑ§Ï†ïÏù¥ Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.');
                document.getElementById('breakerSettingsPopup').classList.add('hidden');
            });
        }

        function toggleSidebar() {
            sidebarCollapsed = !sidebarCollapsed;
            const sidebar = document.getElementById('sidebar');
            if (sidebarCollapsed) {
                sidebar.classList.add('collapsed');
            } else {
                sidebar.classList.remove('collapsed');
            }
        }

        function switchView(view) {
            // Hide all views
            document.querySelectorAll('#heroView, #chatView, #quoteView, #erpView').forEach(v => {
                v.classList.add('hidden');
            });

            // Show target view
            document.getElementById(view + 'View').classList.remove('hidden');
            currentView = view;
        }

        function setActiveNavItem(activeItem) {
            document.querySelectorAll('.sidebar-nav-item').forEach(item => {
                item.classList.remove('active');
            });
            activeItem.classList.add('active');
        }

        function sendFromHero() {
            const input = document.getElementById('heroInput');
            const message = input.value.trim();
            if (!message) return;

            input.value = '';
            switchView('chat');
            addMessage('user', message);
        }

        function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            if (!message || isTyping) return;

            input.value = '';
            addMessage('user', message);
        }

        function addMessage(type, content) {
            const messageId = Date.now().toString();
            const message = { id: messageId, type, content, timestamp: new Date().toLocaleTimeString() };
            messages.push(message);

            const messagesList = document.getElementById('messagesList');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;

            if (type === 'user') {
                messageDiv.innerHTML = `
                    <div class="message-content">${content}</div>
                    <div class="message-avatar">ÎÇò</div>
                `;
            } else {
                messageDiv.innerHTML = `
                    <div class="message-avatar">ü§ñ</div>
                    <div class="message-content">${content}</div>
                `;
            }

            messagesList.appendChild(messageDiv);

            // Auto-scroll
            document.querySelector('.chat-container').scrollTop = document.querySelector('.chat-container').scrollHeight;

            if (type === 'user') {
                // Show typing indicator
                isTyping = true;
                document.getElementById('typingIndicator').classList.remove('hidden');

                // Simulate AI response
                setTimeout(() => {
                    isTyping = false;
                    document.getElementById('typingIndicator').classList.add('hidden');

                    let response = generateAIResponse(content);
                    addMessage('ai', response);
                }, 1200);
            }
        }

        function generateAIResponse(userInput) {
            const responses = {
                'ÌîÑÎ°úÏ†ùÌä∏': 'ÌîÑÎ°úÏ†ùÌä∏ Í¥ÄÎ¶¨Ïóê ÎåÄÌï¥ ÎèÑÏõÄÏùÑ ÎìúÎ¶¨Í≤†ÏäµÎãàÎã§. Ìö®Ïú®Ï†ÅÏù∏ ÌîÑÎ°úÏ†ùÌä∏ Í¥ÄÎ¶¨Î•º ÏúÑÌï¥ÏÑúÎäî Î™ÖÌôïÌïú Î™©Ìëú ÏÑ§Ï†ï, Îã®Í≥ÑÎ≥Ñ Í≥ÑÌöç ÏàòÎ¶Ω, Í∑∏Î¶¨Í≥† Ï†ïÍ∏∞Ï†ÅÏù∏ ÏßÑÌñâ ÏÉÅÌô© Ï†êÍ≤ÄÏù¥ Ï§ëÏöîÌï©ÎãàÎã§.',
                'Í≤¨Ï†Å': 'Í≤¨Ï†ÅÏÑú ÏûëÏÑ±ÏùÑ ÏãúÏûëÌïòÍ≤†ÏäµÎãàÎã§. Ï†ïÌôïÌïú ÏõêÍ∞Ä Í≥ÑÏÇ∞, Ï†ÅÏ†ï Ïù¥ÏùµÎ•† Î∞òÏòÅ, Í≤ΩÏüÅÏÇ¨ Í∞ÄÍ≤© Î∂ÑÏÑù, Í≥†Í∞ù ÏòàÏÇ∞ Í≥†Î†§, Î∂ÄÍ∞ÄÏÑ∏ Î∞è Í∏∞ÌÉÄ ÎπÑÏö© Ìè¨Ìï®Ïù¥ Ï§ëÏöîÌï©ÎãàÎã§.',
                'ERP': 'ERP ÏãúÏä§ÌÖú ÏÇ¨Ïö©Î≤ïÏóê ÎåÄÌï¥ ÏïàÎÇ¥ÎìúÎ¶¨Í≤†ÏäµÎãàÎã§. ÌöåÍ≥Ñ/Ïû¨Î¨¥ Í¥ÄÎ¶¨, Ïù∏ÏÇ¨/Í∏âÏó¨ Í¥ÄÎ¶¨, ÏòÅÏóÖ/Í≥†Í∞ù Í¥ÄÎ¶¨, Íµ¨Îß§/Ïû¨Í≥† Í¥ÄÎ¶¨, ÏÉùÏÇ∞ Í¥ÄÎ¶¨ Î™®ÎìàÏù¥ ÌÜµÌï©Ï†ÅÏúºÎ°ú Ïó∞ÎèôÎê©ÎãàÎã§.',
                'ÏóÖÎ¨¥': 'Ìö®Ïú®Ï†ÅÏù∏ ÏóÖÎ¨¥ Í¥ÄÎ¶¨Î•º ÏúÑÌïú Î™á Í∞ÄÏßÄ Î∞©Î≤ïÏùÑ Ï†úÏïàÎìúÎ¶ΩÎãàÎã§: Ïö∞ÏÑ†ÏàúÏúÑ Îß§Ìä∏Î¶≠Ïä§ ÌôúÏö©, ÏãúÍ∞Ñ Î∏îÎ°ùÌÇπ Í∏∞Î≤ï Ï†ÅÏö©, Ï†ïÍ∏∞Ï†ÅÏù∏ ÏóÖÎ¨¥ Î¶¨Î∑∞, Ï†ÅÏ†àÌïú ÎèÑÍµ¨ ÌôúÏö©, ÌåÄ Ïª§ÎÆ§ÎãàÏºÄÏù¥ÏÖò Í∞ïÌôîÍ∞Ä Ï§ëÏöîÌï©ÎãàÎã§.'
            };

            for (const [keyword, response] of Object.entries(responses)) {
                if (userInput.includes(keyword)) {
                    return response;
                }
            }

            return `"${userInput}"Ïóê ÎåÄÌï¥ Î¨∏ÏùòÌï¥ Ï£ºÏÖ®Íµ∞Ïöî. (Ï£º)ÌïúÍµ≠ÏÇ∞ÏóÖÏùò AI Ïñ¥ÏãúÏä§ÌÑ¥Ìä∏Î°úÏÑú ÏóÖÎ¨¥ Í¥ÄÎ†® ÏßàÎ¨∏Ïóê ÏµúÏÑ†ÏùÑ Îã§Ìï¥ ÎãµÎ≥ÄÎìúÎ¶¨Í≤†ÏäµÎãàÎã§. Íµ¨Ï≤¥Ï†ÅÏúºÎ°ú Ïñ¥Îñ§ ÎèÑÏõÄÏù¥ ÌïÑÏöîÌïòÏã†ÏßÄ ÏïåÎ†§Ï£ºÏãúÎ©¥ Îçî Ï†ïÌôïÌïú Ï†ïÎ≥¥Î•º Ï†úÍ≥µÌï† Ïàò ÏûàÏäµÎãàÎã§.`;
        }

        function updateAccessoryOptions() {
            const category = document.getElementById('accessoryCategory').value;
            const detailSelect = document.getElementById('accessoryDetail');
            const specSelect = document.getElementById('accessorySpec');

            detailSelect.innerHTML = '<option value="">ÏÑ†ÌÉù</option>';
            specSelect.innerHTML = '<option value="">ÏÑ†ÌÉù</option>';

            const options = {
                'meter': {
                    details: ['Îã®ÏÉÅ', 'ÏÇºÏÉÅ'],
                    specs: ['Ï†ÑÏûêÏãù', 'Í∏∞Í≥ÑÏãù']
                },
                '3ct': {
                    details: ['100/5A', '200/5A', '300/5A', '400/5A', '500/5A'],
                    specs: ['Î∂ÄÏä§Î∞îÏö©', 'ÌôòCT']
                },
                'timer': {
                    details: ['ÏùºÎ™∞ÏùºÏ∂ú', 'ÏûÖÎ†•/Ï∂úÎ†•'],
                    specs: ['20A', '30A', '40A', '50A', '75A', '100A']
                },
                'eocr': {
                    details: ['ÏùºÎ∞òÌòï', 'ZCTÎÇ¥Ïû•Ìòï'],
                    specs: ['22', '32', '40', '60']
                },
                'condenser': {
                    details: ['Îã®ÏÉÅ', 'ÏÇºÏÉÅ'],
                    specs: {
                        'Îã®ÏÉÅ': [
                            'uf: 10', 'uf: 15', 'uf: 20', 'uf: 30', 'uf: 40', 'uf: 50', 'uf: 75', 'uf: 100', 'uf: 150', 'uf: 175', 'uf: 200', 'uf: 250', 'uf: 300', 'uf: 400', 'uf: 500', 'uf: 1000',
                            'KVA: 10', 'KVA: 15', 'KVA: 20', 'KVA: 25', 'KVA: 30', 'KVA: 40', 'KVA: 50'
                        ],
                        'ÏÇºÏÉÅ': [
                            'uf: 10', 'uf: 15', 'uf: 20', 'uf: 30', 'uf: 40', 'uf: 50', 'uf: 75', 'uf: 100', 'uf: 200', 'uf: 250', 'uf: 300', 'uf: 400', 'uf: 500',
                            'KVA: 10', 'KVA: 15', 'KVA: 20', 'KVA: 25', 'KVA: 30', 'KVA: 35', 'KVA: 40', 'KVA: 50', 'KVA: 60', 'KVA: 75', 'KVA: 100'
                        ]
                    }
                },
                'etc': {
                    details: ['3Íµ¨ÏΩòÏÑºÌä∏', '2Íµ¨ÏΩòÏÑºÌä∏', 'Î∂ÑÏ†ÑÎ∞òÏÜåÌôîÍ∏∞', 'TR', 'F/S', 'ÏàòÏúÑÏÑºÏÑú', 'Îã®ÏûêÏª§Î≤Ñ', 'Îã®ÏûêÌîºÏª§Î≤Ñ', 'Ïô∏Ìï®Í≤ÄÏπ®Ï∞Ω'],
                    specs: ['ÌëúÏ§Ä', 'ÌäπÏàò']
                }
            };

            if (options[category]) {
                options[category].details.forEach(detail => {
                    const option = document.createElement('option');
                    option.value = detail;
                    option.textContent = detail;
                    detailSelect.appendChild(option);
                });

                if (category !== 'condenser' && Array.isArray(options[category].specs)) {
                    options[category].specs.forEach(spec => {
                        const option = document.createElement('option');
                        option.value = spec;
                        option.textContent = spec;
                        specSelect.appendChild(option);
                    });
                }
            }
        }

        function updateAccessorySpecs() {
            const category = document.getElementById('accessoryCategory').value;
            const detail = document.getElementById('accessoryDetail').value;
            const specSelect = document.getElementById('accessorySpec');

            if (category === 'condenser' && detail) {
                specSelect.innerHTML = '<option value="">ÏÑ†ÌÉù</option>';

                const condenserSpecs = {
                    'Îã®ÏÉÅ': [
                        'uf: 10', 'uf: 15', 'uf: 20', 'uf: 30', 'uf: 40', 'uf: 50', 'uf: 75', 'uf: 100', 'uf: 150', 'uf: 175', 'uf: 200', 'uf: 250', 'uf: 300', 'uf: 400', 'uf: 500', 'uf: 1000',
                        'KVA: 10', 'KVA: 15', 'KVA: 20', 'KVA: 25', 'KVA: 30', 'KVA: 40', 'KVA: 50'
                    ],
                    'ÏÇºÏÉÅ': [
                        'uf: 10', 'uf: 15', 'uf: 20', 'uf: 30', 'uf: 40', 'uf: 50', 'uf: 75', 'uf: 100', 'uf: 200', 'uf: 250', 'uf: 300', 'uf: 400', 'uf: 500',
                        'KVA: 10', 'KVA: 15', 'KVA: 20', 'KVA: 25', 'KVA: 30', 'KVA: 35', 'KVA: 40', 'KVA: 50', 'KVA: 60', 'KVA: 75', 'KVA: 100'
                    ]
                };

                if (condenserSpecs[detail]) {
                    condenserSpecs[detail].forEach(spec => {
                        const option = document.createElement('option');
                        option.value = spec;
                        option.textContent = spec;
                        specSelect.appendChild(option);
                    });
                }
            }
        }

        function addBranchBreaker() {
            const type = document.getElementById('branchType').value;
            const poles = document.getElementById('branchPoles').value;
            const capacity = document.getElementById('branchCapacity').value;
            const quantity = parseInt(document.getElementById('branchQuantity').value) || 1;

            if (!type || !poles || !capacity) {
                alert('Î™®Îì† Ìï≠Î™©ÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }

            const newBreaker = { type, poles, capacity, quantity };
            branchBreakers.push(newBreaker);

            updateBranchList();

            // Reset form
            document.getElementById('branchType').value = '';
            document.getElementById('branchPoles').value = '';
            document.getElementById('branchCapacity').value = '';
            document.getElementById('branchQuantity').value = '1';
        }

        function updateBranchList() {
            const listElement = document.getElementById('branchList');

            if (branchBreakers.length === 0) {
                listElement.innerHTML = '<div class="item-list-empty">Ï∂îÍ∞ÄÎêú Î∂ÑÍ∏∞ Ï∞®Îã®Í∏∞Í∞Ä ÏóÜÏäµÎãàÎã§</div>';
            } else {
                listElement.innerHTML = branchBreakers.map((item, index) => `
                    <div class="item">
                        <span>${item.type} ${item.poles} ${item.capacity} (ÏàòÎüâ: ${item.quantity})</span>
                        <button class="btn" onclick="removeBranchItem(${index})">ÏÇ≠Ï†ú</button>
                    </div>
                `).join('');
            }
        }

        function removeBranchItem(index) {
            branchBreakers.splice(index, 1);
            updateBranchList();
        }

        function addMagnetItem() {
            const model = document.getElementById('magnetModel').value;
            const timer = document.getElementById('magnetTimer').value;
            const pbl = document.getElementById('magnetPBL').value;
            const quantity = parseInt(document.getElementById('magnetQuantity').value) || 1;

            if (!model) {
                alert('ÎßàÍ∑∏ÎÑ§Ìä∏ Î™®Îç∏ÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî.');
                return;
            }

            let specs = model;
            if (timer === 'YES') specs += ' + ÌÉÄÏù¥Î®∏';
            if (pbl === 'YES') specs += ' + PBL';

            const newAccessory = {
                category: 'ÎßàÍ∑∏ÎÑ§Ìä∏',
                detail: specs,
                spec: '',
                quantity: quantity,
                fullName: `ÎßàÍ∑∏ÎÑ§Ìä∏ | ${specs}`
            };

            accessories.push(newAccessory);
            updateAccessoryList();

            // Reset form
            document.getElementById('magnetModel').value = '';
            document.getElementById('magnetTimer').value = '';
            document.getElementById('magnetPBL').value = '';
            document.getElementById('magnetQuantity').value = '1';
        }

        function addAccessoryItem() {
            const category = document.getElementById('accessoryCategory').value;
            const detail = document.getElementById('accessoryDetail').value;
            const spec = document.getElementById('accessorySpec').value;
            const quantity = parseInt(document.getElementById('accessoryQuantity').value) || 1;

            if (!category || !detail) {
                alert('Î∂ÄÏÜçÏûêÏû¨ÏôÄ ÏÑ∏Î∂ÄÏÑ†ÌÉùÏùÑ Î™®Îëê ÏÑ†ÌÉùÌïòÏÑ∏Ïöî.');
                return;
            }

            let itemName = category;
            if (detail) itemName += ' - ' + detail;
            if (spec) itemName += ' (' + spec + ')';

            const newAccessory = {
                category,
                detail,
                spec,
                quantity,
                fullName: itemName
            };

            accessories.push(newAccessory);
            updateAccessoryList();

            // Reset form
            document.getElementById('accessoryCategory').value = '';
            document.getElementById('accessoryDetail').innerHTML = '<option value="">ÏÑ†ÌÉù</option>';
            document.getElementById('accessorySpec').innerHTML = '<option value="">ÏÑ†ÌÉù</option>';
            document.getElementById('accessoryQuantity').value = '1';
        }

        function updateAccessoryList() {
            const listElement = document.getElementById('accessoryList');

            if (accessories.length === 0) {
                listElement.innerHTML = '<div class="item-list-empty">Ï∂îÍ∞ÄÎêú Î∂ÄÏÜçÏûêÏû¨Í∞Ä ÏóÜÏäµÎãàÎã§</div>';
            } else {
                listElement.innerHTML = accessories.map((item, index) => `
                    <div class="item">
                        <span>${item.fullName} (ÏàòÎüâ: ${item.quantity})</span>
                        <button class="btn" onclick="removeAccessoryItem(${index})">ÏÇ≠Ï†ú</button>
                    </div>
                `).join('');
            }
        }

        function removeAccessoryItem(index) {
            accessories.splice(index, 1);
            updateAccessoryList();
        }

        function generateEstimate() {
            document.getElementById('estimateEmpty').classList.add('hidden');
            document.getElementById('estimateResult').classList.remove('hidden');

            updateEstimateTable();
            estimateVisible = true;
        }

        function updateEstimateTable() {
            const tbody = document.querySelector('#estimateTable tbody');
            let totalAmount = 0;
            let rows = '';

            // Ïô∏Ìï®
            const enclosurePrice = 850000;
            totalAmount += enclosurePrice;
            rows += `
                <tr>
                    <td>Ïô∏Ìï® (${enclosureInfo.boxType || 'Í∏∞ÏÑ±Ìï®'} - ${enclosureInfo.material || 'STEEL 1.6T'})</td>
                    <td class="text-center">1</td>
                    <td class="text-right">${enclosurePrice.toLocaleString()}</td>
                    <td class="text-right">${enclosurePrice.toLocaleString()}</td>
                </tr>
            `;

            // Î©îÏù∏Ï∞®Îã®Í∏∞
            const mainBreakerPrice = 450000;
            totalAmount += mainBreakerPrice;
            rows += `
                <tr>
                    <td>Î©îÏù∏Ï∞®Îã®Í∏∞ (${mainBreakerInfo.type} ${mainBreakerInfo.poles} ${mainBreakerInfo.capacity})</td>
                    <td class="text-center">1</td>
                    <td class="text-right">${mainBreakerPrice.toLocaleString()}</td>
                    <td class="text-right">${mainBreakerPrice.toLocaleString()}</td>
                </tr>
            `;

            // Î∂ÑÍ∏∞Ï∞®Îã®Í∏∞
            branchBreakers.forEach(item => {
                const price = 75000 * item.quantity;
                totalAmount += price;
                rows += `
                    <tr>
                        <td>Î∂ÑÍ∏∞Ï∞®Îã®Í∏∞ (${item.type} ${item.poles} ${item.capacity})</td>
                        <td class="text-center">${item.quantity}</td>
                        <td class="text-right">75,000</td>
                        <td class="text-right">${price.toLocaleString()}</td>
                    </tr>
                `;
            });

            // Î∂ÄÏÜçÏûêÏû¨
            accessories.forEach(item => {
                const price = 125000 * item.quantity;
                totalAmount += price;
                rows += `
                    <tr>
                        <td>${item.fullName}</td>
                        <td class="text-center">${item.quantity}</td>
                        <td class="text-right">125,000</td>
                        <td class="text-right">${price.toLocaleString()}</td>
                    </tr>
                `;
            });

            tbody.innerHTML = rows;
            document.getElementById('totalAmount').textContent = `Ï¥ùÏï°: ${totalAmount.toLocaleString()}Ïõê`;
        }

        function addNewTab() {
            const newTab = {
                id: nextTabId,
                title: `Í≤¨Ï†ÅÏÑú ${nextTabId}`,
                customerInfo: { company: '', contact: '', email: '', address: '' },
                enclosureInfo: { type: 'Ïò•ÎÇ¥', boxType: '', material: '', request: '' },
                mainBreakerInfo: { type: 'MCCB', poles: '', capacity: '', brand: '' },
                branchBreakers: [],
                accessories: [],
                estimateVisible: false
            };

            tabs.push(newTab);
            updateTabsUI();
            switchTab(nextTabId);
            nextTabId++;
        }

        function switchTab(tabId) {
            activeTabId = tabId;
            const tab = tabs.find(t => t.id === tabId);

            if (tab) {
                // Load tab data
                customerInfo = {...tab.customerInfo};
                enclosureInfo = {...tab.enclosureInfo};
                mainBreakerInfo = {...tab.mainBreakerInfo};
                branchBreakers = [...tab.branchBreakers];
                accessories = [...tab.accessories];
                estimateVisible = tab.estimateVisible;

                updateFormData();
                updateTabsUI();
            }
        }

        function updateTabsUI() {
            const tabsContainer = document.getElementById('quoteTabs');
            tabsContainer.innerHTML = tabs.map(tab => `
                <div class="quote-tab ${tab.id === activeTabId ? 'active' : ''}" onclick="switchTab(${tab.id})">
                    ${tab.title}
                    ${tabs.length > 1 ? `<span class="tab-close" onclick="event.stopPropagation(); closeTab(${tab.id})">√ó</span>` : ''}
                </div>
            `).join('');
        }

        function closeTab(tabId) {
            if (tabs.length === 1) return;

            tabs = tabs.filter(tab => tab.id !== tabId);

            if (tabId === activeTabId) {
                switchTab(tabs[0].id);
            } else {
                updateTabsUI();
            }
        }

        function updateFormData() {
            // Customer info
            document.getElementById('companyName').value = customerInfo.company;
            document.getElementById('contact').value = customerInfo.contact;
            document.getElementById('email').value = customerInfo.email;
            document.getElementById('address').value = customerInfo.address;

            // Enclosure info
            document.getElementById('boxType').value = enclosureInfo.boxType;
            document.getElementById('material').value = enclosureInfo.material;
            document.getElementById('specialRequest').value = enclosureInfo.request;

            // Main breaker
            document.getElementById('mainPoles').value = mainBreakerInfo.poles;
            document.getElementById('mainCapacity').value = mainBreakerInfo.capacity;

            // Update lists
            updateBranchList();
            updateAccessoryList();

            // Update estimate
            if (estimateVisible) {
                document.getElementById('estimateEmpty').classList.add('hidden');
                document.getElementById('estimateResult').classList.remove('hidden');
                updateEstimateTable();
            } else {
                document.getElementById('estimateEmpty').classList.remove('hidden');
                document.getElementById('estimateResult').classList.add('hidden');
            }
        }

        // AI Chat Functions
        function toggleAiChat() {
            aiChatVisible = !aiChatVisible;
            const popup = document.getElementById('aiChatPopup');
            if (aiChatVisible) {
                popup.classList.add('visible');
            } else {
                popup.classList.remove('visible');
            }
        }

        function sendAiMessage() {
            const input = document.getElementById('aiChatInput');
            const message = input.value.trim();
            if (!message) return;

            addAiMessage('user', message);
            input.value = '';

            setTimeout(() => {
                addAiMessage('ai', 'Í≤¨Ï†Å Í¥ÄÎ†® ÎèÑÏõÄÏùÑ ÎìúÎ¶¨Í≤†ÏäµÎãàÎã§. Íµ¨Ï≤¥Ï†ÅÏù∏ ÏßàÎ¨∏Ïù¥ ÏûàÏúºÏãúÎ©¥ ÏïåÎ†§Ï£ºÏÑ∏Ïöî.');
            }, 1000);
        }

        function addAiMessage(type, content) {
            const messagesContainer = document.getElementById('aiChatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `${type}-message`;
            messageDiv.textContent = content;
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function handleAiFileSelect(e) {
            const files = Array.from(e.target.files);
            aiFiles = [...aiFiles, ...files];

            if (files.length > 0) {
                const fileList = document.getElementById('aiFileList');
                fileList.classList.remove('hidden');
                fileList.innerHTML = aiFiles.map((file, index) => `
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px 12px; background: #f9f9f9; border-radius: 4px; margin-bottom: 5px;">
                        <span>${file.name}</span>
                        <button onclick="removeAiFile(${index})">√ó</button>
                    </div>
                `).join('') + `
                    <button onclick="analyzeFiles()" style="width: 100%; padding: 8px; background: var(--color-brand); color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px; margin-bottom: 10px;">
                        AI Î∂ÑÏÑù ÏãúÏûë
                    </button>
                `;
            }
        }

        function removeAiFile(index) {
            aiFiles.splice(index, 1);
            if (aiFiles.length === 0) {
                document.getElementById('aiFileList').classList.add('hidden');
            } else {
                handleAiFileSelect({target: {files: []}});
            }
        }

        function analyzeFiles() {
            if (aiFiles.length === 0) {
                alert('Î∂ÑÏÑùÌï† ÌååÏùºÏùÑ Î®ºÏ†Ä ÏóÖÎ°úÎìúÌïòÏÑ∏Ïöî.');
                return;
            }

            addAiMessage('ai', 'üìä AIÍ∞Ä ÌååÏùºÏùÑ Î∂ÑÏÑùÌïòÍ≥† ÏûàÏäµÎãàÎã§...');

            setTimeout(() => {
                fillFormAutomatically();
                addAiMessage('ai', '‚úÖ Î∂ÑÏÑù ÏôÑÎ£å! ÎèÑÎ©¥ÏùÑ Î∂ÑÏÑùÌïòÏó¨ ÏûêÎèôÏúºÎ°ú Í≤¨Ï†Å Ï†ïÎ≥¥Î•º ÏûÖÎ†•ÌñàÏäµÎãàÎã§. Í≤¨Ï†Å ÏÉùÏÑ± Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠ÌïòÎ©¥ ÏµúÏ¢Ö Í≤¨Ï†ÅÏù¥ ÏÉùÏÑ±Îê©ÎãàÎã§.');
                aiFiles = [];
                document.getElementById('aiFileList').classList.add('hidden');
            }, 3000);
        }

        function fillFormAutomatically() {
            // Auto-fill customer info
            customerInfo.company = '„àúÌïúÍµ≠Ï†ÑÍ∏∞Í≥µÏóÖ';
            customerInfo.contact = '02-1234-5678';
            customerInfo.email = 'contact@hkelectric.co.kr';
            customerInfo.address = 'ÏÑúÏö∏Ïãú Í∞ïÎÇ®Íµ¨ ÌÖåÌó§ÎûÄÎ°ú 123';

            // Auto-fill enclosure info
            enclosureInfo.boxType = 'Í∏∞ÏÑ±Ìï®';
            enclosureInfo.material = 'STEEL 1.6T';

            // Auto-fill main breaker
            mainBreakerInfo.poles = '4P';
            mainBreakerInfo.capacity = '200A';

            updateFormData();
            generateEstimate();
        }
    </script>
</body>
</html>